<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Try Quoted Free - Generate a Real Quote</title>
    <meta name="description" content="Try Quoted without signing up. Generate a real quote using AI - works for contractors, designers, consultants, and any service business.">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' rx='6' fill='%230a0a0a'/%3E%3Ctext x='16' y='23' font-family='serif' font-size='20' font-weight='600' fill='white' text-anchor='middle'%3EQ%3C/text%3E%3C/svg%3E">

    <!-- Google Ads Conversion Tracking -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17836503504"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'AW-17836503504');
    </script>

    <!-- PostHog Analytics -->
    <script>
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
        {% if posthog_api_key %}
        posthog.init('{{ posthog_api_key }}', {api_host: 'https://us.i.posthog.com'});
        {% endif %}
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #141414;
            --bg-card: #1a1a1a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #666666;
            --border: rgba(255, 255, 255, 0.1);
            --border-hover: rgba(255, 255, 255, 0.2);
            --success: #4ade80;
            --warning: #fbbf24;
            --accent: #6366f1;
            --demo-badge: #f59e0b;
            --font-serif: 'Playfair Display', Georgia, serif;
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            min-height: 100vh;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 24px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border);
        }

        .logo {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            font-weight: 500;
            letter-spacing: -0.02em;
            color: var(--text-primary);
            text-decoration: none;
        }

        .logo span {
            font-style: italic;
        }

        .nav-cta {
            padding: 12px 24px;
            min-height: 44px;
            background: var(--text-primary);
            color: var(--bg-primary);
            font-family: var(--font-sans);
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .nav-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.2);
        }

        /* Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 120px 24px 80px;
        }

        /* Demo Badge */
        .demo-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: var(--demo-badge);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 24px;
        }

        .demo-badge svg {
            width: 14px;
            height: 14px;
        }

        /* Header */
        .page-header {
            text-align: center;
            margin-bottom: 48px;
        }

        .page-header h1 {
            font-family: var(--font-serif);
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 500;
            letter-spacing: -0.02em;
            margin-bottom: 16px;
        }

        .page-header p {
            color: var(--text-secondary);
            font-size: 1.125rem;
            max-width: 600px;
            margin: 0 auto 24px;
        }

        /* Learning Disclaimer */
        .learning-disclaimer {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            padding: 20px 24px;
            margin-bottom: 32px;
        }

        .learning-disclaimer h3 {
            color: #a5b4fc;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .learning-disclaimer p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.6;
        }

        /* Input Section */
        .input-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
        }

        .input-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
        }

        .input-tab {
            padding: 12px 24px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-family: var(--font-sans);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .input-tab:hover {
            border-color: var(--text-secondary);
        }

        .input-tab.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
        }

        /* Voice Recording */
        .voice-input {
            text-align: center;
        }

        .record-btn {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--accent);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            transition: all 0.3s ease;
        }

        .record-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.4);
        }

        .record-btn.recording {
            background: #ef4444;
            animation: pulse-record 1s infinite;
        }

        @keyframes pulse-record {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 30px rgba(239, 68, 68, 0); }
        }

        .record-btn svg {
            width: 48px;
            height: 48px;
            fill: white;
        }

        .record-status {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 16px;
        }

        .waveform {
            display: none;
            align-items: center;
            justify-content: center;
            gap: 4px;
            height: 50px;
            margin-bottom: 20px;
        }

        .waveform.visible {
            display: flex;
        }

        .waveform-bar {
            width: 6px;
            background: var(--accent);
            border-radius: 3px;
            animation: wave 0.5s ease-in-out infinite alternate;
        }

        @keyframes wave {
            from { height: 15px; }
            to { height: 40px; }
        }

        .waveform-bar:nth-child(1) { animation-delay: 0s; }
        .waveform-bar:nth-child(2) { animation-delay: 0.1s; }
        .waveform-bar:nth-child(3) { animation-delay: 0.2s; }
        .waveform-bar:nth-child(4) { animation-delay: 0.3s; }
        .waveform-bar:nth-child(5) { animation-delay: 0.4s; }
        .waveform-bar:nth-child(6) { animation-delay: 0.3s; }
        .waveform-bar:nth-child(7) { animation-delay: 0.2s; }
        .waveform-bar:nth-child(8) { animation-delay: 0.1s; }

        /* Text Input */
        .text-input textarea {
            width: 100%;
            min-height: 150px;
            padding: 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: var(--font-sans);
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 16px;
        }

        .text-input textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .text-input textarea::placeholder {
            color: var(--text-muted);
        }

        .example-prompts {
            margin-bottom: 20px;
        }

        .example-prompts p {
            color: var(--text-secondary);
            font-size: 0.75rem;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .example-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .example-chip {
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            color: var(--text-secondary);
            font-size: 0.8125rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .example-chip:hover {
            border-color: var(--accent);
            color: var(--text-primary);
        }

        .generate-btn {
            width: 100%;
            padding: 16px 32px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 12px;
            font-family: var(--font-sans);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .generate-btn:hover:not(:disabled) {
            background: #5558e3;
            transform: translateY(-2px);
        }

        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .generate-btn .spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid white;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .generate-btn.loading .spinner {
            display: block;
        }

        .generate-btn.loading span {
            display: none;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Progress Indicator - Enhanced UX for ~15s quote generation */
        .progress-container {
            display: none;
            margin-top: 24px;
            padding: 24px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            text-align: center;
        }

        .progress-container.visible {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .progress-bar-container {
            width: 100%;
            height: 6px;
            background: var(--bg-card);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--accent), #a855f7);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .progress-step {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .progress-spinner {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .progress-message {
            font-size: 1rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .progress-estimate {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .progress-steps-list {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 16px;
        }

        .progress-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border);
            transition: all 0.3s ease;
        }

        .progress-dot.active {
            background: var(--accent);
            transform: scale(1.3);
        }

        .progress-dot.completed {
            background: var(--success);
        }

        /* Results Section */
        .results-section {
            display: none;
        }

        .results-section.visible {
            display: block;
        }

        .result-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 24px;
        }

        .result-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-header h2 {
            font-family: var(--font-serif);
            font-size: 1.25rem;
            font-weight: 500;
        }

        .confidence-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .confidence-badge.high {
            background: rgba(74, 222, 128, 0.1);
            color: var(--success);
        }

        .confidence-badge.medium {
            background: rgba(251, 191, 36, 0.1);
            color: var(--warning);
        }

        .confidence-badge.low {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }

        .result-body {
            padding: 24px;
        }

        .job-description {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            margin-bottom: 24px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--border);
        }

        .line-items {
            margin-bottom: 24px;
        }

        .line-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 16px 0;
            border-bottom: 1px solid var(--border);
        }

        .line-item:last-child {
            border-bottom: none;
        }

        .line-item-info {
            flex: 1;
        }

        .line-item-name {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .line-item-desc {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .line-item-amount {
            font-weight: 600;
            font-size: 1.125rem;
            padding-left: 24px;
        }

        .quote-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            background: var(--bg-card);
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .quote-total-label {
            font-size: 1.125rem;
            font-weight: 500;
        }

        .quote-total-amount {
            font-family: var(--font-serif);
            font-size: 2rem;
            font-weight: 600;
        }

        /* Quote Notes */
        .quote-notes {
            background: rgba(99, 102, 241, 0.05);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .quote-notes h4 {
            color: #a5b4fc;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .quote-notes p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            white-space: pre-wrap;
        }

        /* Questions */
        .quote-questions {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .quote-questions h4 {
            color: var(--warning);
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .question-list {
            list-style: none;
        }

        .question-list li {
            color: var(--text-secondary);
            font-size: 0.875rem;
            padding: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .question-list li::before {
            content: "?";
            position: absolute;
            left: 0;
            color: var(--warning);
            font-weight: 600;
        }

        /* DISC-132: Interactive Clarifying Questions */
        .question-item {
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .question-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .question-item label {
            display: block;
            color: var(--text-primary);
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .question-item label::before {
            content: "?";
            position: absolute;
            left: 0;
            color: var(--warning);
            font-weight: 600;
        }

        .question-item input {
            width: 100%;
            padding: 10px 12px;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.875rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .question-item input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .question-item input::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }

        .regenerate-btn {
            width: 100%;
            margin-top: 16px;
            padding: 12px 20px;
            background: var(--warning);
            border: none;
            border-radius: 8px;
            color: var(--bg);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: background 0.2s, transform 0.1s;
        }

        .regenerate-btn:hover {
            background: #e5a800;
            transform: translateY(-1px);
        }

        .regenerate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .regenerate-btn svg {
            width: 16px;
            height: 16px;
        }

        .regenerate-btn.loading {
            pointer-events: none;
        }

        .regenerate-btn.loading::after {
            content: "";
            width: 16px;
            height: 16px;
            border: 2px solid var(--bg);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-left: 8px;
        }

        /* Action Buttons */
        .result-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .action-btn {
            flex: 1;
            min-width: 200px;
            padding: 14px 24px;
            border-radius: 10px;
            font-family: var(--font-sans);
            font-size: 0.9375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .action-btn.primary {
            background: var(--text-primary);
            color: var(--bg-primary);
            border: none;
        }

        .action-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(255, 255, 255, 0.2);
        }

        .action-btn.secondary {
            background: transparent;
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .action-btn.secondary:hover {
            border-color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .action-btn svg {
            width: 18px;
            height: 18px;
        }

        /* DISC-113: Time Savings Calculator */
        .time-savings-section {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 16px;
            padding: 32px;
            text-align: center;
            margin-top: 32px;
        }

        .time-savings-section h3 {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            font-weight: 500;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .time-savings-intro {
            color: var(--text-secondary);
            margin-bottom: 24px;
            font-size: 0.95rem;
        }

        .calculator-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .calculator-row label {
            font-size: 0.95rem;
            color: var(--text-primary);
        }

        .calculator-row input {
            width: 70px;
            padding: 10px 14px;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
            transition: border-color 0.2s;
        }

        .calculator-row input:focus {
            outline: none;
            border-color: var(--success);
        }

        .savings-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            max-width: 500px;
            margin: 0 auto 20px;
        }

        @media (max-width: 500px) {
            .savings-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
        }

        .savings-card {
            background: var(--bg-card);
            border-radius: 10px;
            padding: 16px;
            text-align: center;
        }

        .savings-card .label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .savings-card .value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--success);
            line-height: 1.2;
        }

        .savings-card .unit {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .savings-card.highlight {
            background: linear-gradient(135deg, var(--success) 0%, #10b981 100%);
            transform: scale(1.03);
        }

        .savings-card.highlight .label,
        .savings-card.highlight .unit {
            color: rgba(255, 255, 255, 0.9);
        }

        .savings-card.highlight .value {
            color: #fff;
        }

        .savings-insight {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-style: italic;
        }

        .savings-insight strong {
            color: var(--success);
        }

        /* CTA Section */
        .cta-section {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.05));
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            margin-top: 48px;
        }

        .cta-section h2 {
            font-family: var(--font-serif);
            font-size: 1.75rem;
            font-weight: 500;
            margin-bottom: 12px;
        }

        .cta-section p {
            color: var(--text-secondary);
            margin-bottom: 24px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-benefits {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .cta-benefit {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--success);
            font-size: 0.875rem;
        }

        .cta-benefit svg {
            width: 16px;
            height: 16px;
        }

        .cta-btn {
            display: inline-block;
            padding: 16px 48px;
            background: var(--text-primary);
            color: var(--bg-primary);
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .cta-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(255, 255, 255, 0.2);
        }

        /* Error Message */
        .error-message {
            display: none;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 24px;
            color: #fca5a5;
        }

        .error-message.visible {
            display: block;
        }

        /* Responsive */
        @media (max-width: 768px) {
            nav {
                padding: 16px 20px;
            }

            .container {
                padding: 100px 16px 48px;
            }

            .input-section {
                padding: 24px 16px;
            }

            .result-actions {
                flex-direction: column;
            }

            .action-btn {
                min-width: 100%;
            }

            .cta-benefits {
                flex-direction: column;
                gap: 16px;
            }
        }

        /* ========== DISC-110: Product Tour System ========== */

        /* Tour Overlay */
        .tour-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 900;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .tour-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* DISC-155: Lock body scroll during tour */
        body.tour-active {
            overflow: hidden;
            position: fixed;
            width: 100%;
        }

        /* Tour Spotlight - cuts through overlay */
        .tour-spotlight {
            position: fixed;
            border-radius: 12px;
            box-shadow:
                0 0 0 4px rgba(99, 102, 241, 0.5),
                0 0 0 9999px rgba(0, 0, 0, 0.6);
            z-index: 901;
            pointer-events: none;
            opacity: 0;
            transition: all 0.4s ease;
        }

        .tour-spotlight.active {
            opacity: 1;
        }

        /* Tour Tooltip */
        .tour-tooltip {
            position: fixed;
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            padding: 24px;
            max-width: 340px;
            width: calc(100% - 32px);
            z-index: 902;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .tour-tooltip.active {
            opacity: 1;
            transform: translateY(0);
        }

        .tour-tooltip-badge {
            display: inline-block;
            padding: 4px 12px;
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            color: white;
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            border-radius: 100px;
            margin-bottom: 12px;
        }

        .tour-tooltip-title {
            font-family: var(--font-serif);
            font-size: 1.25rem;
            font-weight: 500;
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .tour-tooltip-body {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .tour-tooltip-highlight {
            color: var(--success);
            font-weight: 500;
        }

        /* DISC-155: Demo note styling - clarifies demo vs account features */
        .tour-demo-note {
            margin-top: 12px;
            padding: 10px 12px;
            background: rgba(99, 102, 241, 0.1);
            border-left: 3px solid var(--primary);
            border-radius: 0 6px 6px 0;
            font-size: 0.8125rem;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* Tour Navigation */
        .tour-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
        }

        .tour-nav-progress {
            display: flex;
            gap: 6px;
        }

        .tour-progress-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--border);
            transition: all 0.3s ease;
        }

        .tour-progress-dot.active {
            background: var(--accent);
            width: 16px;
            border-radius: 3px;
        }

        .tour-progress-dot.completed {
            background: var(--success);
        }

        .tour-nav-buttons {
            display: flex;
            gap: 8px;
        }

        .tour-btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            font-family: var(--font-sans);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 40px;
        }

        .tour-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-color: var(--border-hover);
        }

        .tour-btn.primary {
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            border-color: transparent;
            color: white;
        }

        .tour-btn.primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        }

        .tour-btn.cta {
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            border-color: transparent;
            color: var(--bg-primary);
            font-weight: 600;
        }

        .tour-btn.cta:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(0, 255, 136, 0.4);
        }

        /* Tour Welcome Modal */
        .tour-welcome {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            max-width: 440px;
            width: calc(100% - 40px);
            text-align: center;
            z-index: 902;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .tour-welcome.active {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1);
        }

        .tour-welcome-icon {
            width: 72px;
            height: 72px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tour-welcome-icon svg {
            width: 36px;
            height: 36px;
            stroke: white;
        }

        .tour-welcome h2 {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            margin-bottom: 12px;
        }

        .tour-welcome p {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 28px;
            line-height: 1.5;
        }

        .tour-welcome-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .tour-welcome-skip {
            background: none;
            border: none;
            color: var(--text-muted);
            font-family: var(--font-sans);
            font-size: 0.875rem;
            cursor: pointer;
            transition: color 0.2s ease;
            padding: 8px;
        }

        .tour-welcome-skip:hover {
            color: var(--text-secondary);
        }

        /* Tour Feature Preview Cards */
        .tour-preview-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
            border: 1px solid var(--border);
        }

        .tour-preview-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
            font-size: 0.875rem;
        }

        .tour-preview-row:last-child {
            border-bottom: none;
        }

        .tour-preview-label {
            color: var(--text-secondary);
        }

        .tour-preview-value {
            color: var(--text-primary);
            font-weight: 500;
        }

        .tour-preview-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid rgba(74, 222, 128, 0.2);
            border-radius: 100px;
            color: var(--success);
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* Tour Final CTA */
        .tour-final {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 48px 40px;
            max-width: 500px;
            width: calc(100% - 40px);
            text-align: center;
            z-index: 902;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .tour-final.active {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1);
        }

        .tour-final-checkmark {
            width: 80px;
            height: 80px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tour-final-checkmark svg {
            width: 40px;
            height: 40px;
            stroke: var(--bg-primary);
            stroke-width: 3;
        }

        .tour-final h2 {
            font-family: var(--font-serif);
            font-size: 1.75rem;
            margin-bottom: 12px;
        }

        .tour-final-subtitle {
            color: var(--text-secondary);
            font-size: 1.0625rem;
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .tour-feature-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 32px;
        }

        .tour-feature-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            font-size: 0.875rem;
        }

        .tour-feature-item svg {
            width: 18px;
            height: 18px;
            stroke: var(--success);
            flex-shrink: 0;
        }

        .tour-final-cta {
            display: block;
            width: 100%;
            padding: 16px 32px;
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            color: var(--bg-primary);
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            border-radius: 12px;
            transition: all 0.3s ease;
            margin-bottom: 16px;
        }

        .tour-final-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 255, 136, 0.4);
        }

        .tour-final-secondary {
            color: var(--text-muted);
            font-size: 0.875rem;
            cursor: pointer;
            transition: color 0.2s ease;
            background: none;
            border: none;
            font-family: var(--font-sans);
        }

        .tour-final-secondary:hover {
            color: var(--text-secondary);
        }

        /* DISC-157: Tour Restart Button */
        .tour-restart-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: var(--text-secondary);
            font-size: 0.8125rem;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: transparent;
            border: none;
            margin-top: 16px;
        }

        .tour-restart-link:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .tour-restart-link svg {
            width: 14px;
            height: 14px;
            opacity: 0.7;
        }

        /* Mobile Tour Styles */
        @media (max-width: 768px) {
            .tour-tooltip {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                max-width: none;
                width: 100%;
                border-radius: 20px 20px 0 0;
                padding: 24px 20px 32px;
                transform: translateY(100%);
            }

            .tour-tooltip.active {
                transform: translateY(0);
            }

            .tour-spotlight {
                max-height: calc(100vh - 200px);
            }

            .tour-welcome,
            .tour-final {
                padding: 32px 24px;
                border-radius: 20px;
            }

            .tour-feature-grid {
                grid-template-columns: 1fr;
            }

            .tour-nav {
                flex-direction: column;
                gap: 16px;
            }

            .tour-nav-buttons {
                width: 100%;
            }

            .tour-nav-buttons .tour-btn {
                flex: 1;
            }

            .tour-restart-link {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <a href="/" class="logo">quoted<span>.it</span></a>
        <div style="display: flex; gap: 24px; align-items: center;">
            <a href="/use-cases" style="color: var(--text-secondary); text-decoration: none; font-size: 0.9rem; transition: color 0.2s;">Use Cases</a>
            <a href="/app" class="nav-cta">Sign Up Free</a>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <!-- Header -->
        <div class="page-header">
            <div class="demo-badge">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                    <path d="M2 17l10 5 10-5"/>
                    <path d="M2 12l10 5 10-5"/>
                </svg>
                Demo Mode - Try Without Signup
            </div>
            <h1>Generate a Real Quote</h1>
            <p>Describe any job or project. Works for contractors, designers, consultants, event planners - any service business.</p>
        </div>

        <!-- Learning Disclaimer -->
        <div class="learning-disclaimer">
            <h3>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4"/>
                    <path d="M12 8h.01"/>
                </svg>
                Demo Uses Industry-Standard Pricing
            </h3>
            <p>This demo generates estimates using general industry knowledge. When you sign up, Quoted learns YOUR specific pricing from every quote you create and correct. The more you use it, the more accurate it becomes - eventually matching exactly how you price jobs.</p>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="input-tabs">
                <button class="input-tab active" data-tab="voice" id="voiceTab">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                        <line x1="12" y1="19" x2="12" y2="23"/>
                        <line x1="8" y1="23" x2="16" y2="23"/>
                    </svg>
                    Voice
                </button>
                <button class="input-tab" data-tab="text" id="textTab">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align: middle; margin-right: 6px;">
                        <line x1="17" y1="10" x2="3" y2="10"/>
                        <line x1="21" y1="6" x2="3" y2="6"/>
                        <line x1="21" y1="14" x2="3" y2="14"/>
                        <line x1="17" y1="18" x2="3" y2="18"/>
                    </svg>
                    Text
                </button>
            </div>

            <!-- Voice Input -->
            <div class="input-content active" id="voiceContent">
                <div class="voice-input">
                    <button class="record-btn" id="recordBtn" aria-label="Record voice">
                        <svg id="micIcon" viewBox="0 0 24 24">
                            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                            <path d="M19 10v2a7 7 0 0 1-14 0v-2" fill="none" stroke="white" stroke-width="2"/>
                            <line x1="12" y1="19" x2="12" y2="23" stroke="white" stroke-width="2"/>
                            <line x1="8" y1="23" x2="16" y2="23" stroke="white" stroke-width="2"/>
                        </svg>
                    </button>
                    <div class="waveform" id="waveform">
                        <div class="waveform-bar"></div>
                        <div class="waveform-bar"></div>
                        <div class="waveform-bar"></div>
                        <div class="waveform-bar"></div>
                        <div class="waveform-bar"></div>
                        <div class="waveform-bar"></div>
                        <div class="waveform-bar"></div>
                        <div class="waveform-bar"></div>
                    </div>
                    <p class="record-status" id="recordStatus">Tap to start recording</p>
                </div>
            </div>

            <!-- Text Input -->
            <div class="input-content" id="textContent">
                <div class="text-input">
                    <textarea id="descriptionInput" placeholder="Describe the job in detail. Include scope, materials, customer info if known...&#10;&#10;Example: Kitchen remodel for the Johnson family at 123 Oak Street. New cabinets, countertops, backsplash tile. About 150 square feet of countertop space."></textarea>

                    <div class="example-prompts">
                        <p>Try an example:</p>
                        <div class="example-chips">
                            <button class="example-chip" data-example="Bathroom remodel - new tile floor, vanity replacement, and paint. About 80 square feet. Customer is Sarah Miller.">Bathroom Remodel</button>
                            <button class="example-chip" data-example="Wedding photography for Jennifer and Mark on June 15th. 8 hours coverage, second shooter, engagement session included. 400+ edited photos.">Wedding Photography</button>
                            <button class="example-chip" data-example="Website redesign for a local restaurant. 5-6 pages, online menu, reservation system integration, mobile responsive.">Website Design</button>
                            <button class="example-chip" data-example="Move a 3-bedroom house across town. Packing service needed. Estimated 20 boxes, couch, dining set, 2 beds.">Moving Service</button>
                        </div>
                    </div>

                    <button class="generate-btn" id="generateBtn">
                        <div class="spinner"></div>
                        <span>Generate Quote</span>
                    </button>

                    <!-- Progress Indicator - Enhanced UX for ~15s generation -->
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progressBar"></div>
                        </div>
                        <div class="progress-step">
                            <div class="progress-spinner"></div>
                            <span class="progress-message" id="progressMessage">Analyzing your job description...</span>
                        </div>
                        <p class="progress-estimate">Usually takes about 10-15 seconds</p>
                        <div class="progress-steps-list">
                            <div class="progress-dot active" id="dot1"></div>
                            <div class="progress-dot" id="dot2"></div>
                            <div class="progress-dot" id="dot3"></div>
                            <div class="progress-dot" id="dot4"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Message -->
        <div class="error-message" id="errorMessage"></div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection">
            <div class="result-card">
                <div class="result-header">
                    <h2 id="jobType">Quote</h2>
                    <span class="confidence-badge medium" id="confidenceBadge">Medium Confidence</span>
                </div>
                <div class="result-body">
                    <p class="job-description" id="jobDescription"></p>

                    <div class="line-items" id="lineItems">
                        <!-- Line items will be inserted here -->
                    </div>

                    <div class="quote-total">
                        <span class="quote-total-label">Estimated Total</span>
                        <span class="quote-total-amount" id="quoteTotal">$0</span>
                    </div>

                    <div class="quote-notes" id="notesSection">
                        <h4>Notes</h4>
                        <p id="quoteNotes"></p>
                    </div>

                    <!-- DISC-132: Interactive Clarifying Questions -->
                    <div class="quote-questions" id="questionsSection">
                        <h4>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                                <path d="M12 17h.01"/>
                            </svg>
                            Answer for a More Accurate Quote
                        </h4>
                        <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 16px;">
                            Provide details below and we'll refine your estimate.
                        </p>
                        <div class="question-list" id="questionList">
                            <!-- Questions will be inserted here as form fields -->
                        </div>
                        <button type="button" class="regenerate-btn" id="regenerateBtn" style="display: none;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 4v6h6"/>
                                <path d="M23 20v-6h-6"/>
                                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                            </svg>
                            Regenerate Quote with My Answers
                        </button>
                    </div>

                    <div class="result-actions">
                        <button class="action-btn primary" id="downloadPdfBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="7 10 12 15 17 10"/>
                                <line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                            Download PDF
                        </button>
                        <button class="action-btn secondary" id="shareQuoteBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="18" cy="5" r="3"/>
                                <circle cx="6" cy="12" r="3"/>
                                <circle cx="18" cy="19" r="3"/>
                                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
                                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
                            </svg>
                            Share This Quote
                        </button>
                        <button class="action-btn secondary" id="tryAgainBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 4v6h6"/>
                                <path d="M23 20v-6h-6"/>
                                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                            </svg>
                            Try Another Quote
                        </button>
                    </div>

                    <!-- DISC-157: Tour restart capability -->
                    <button class="tour-restart-link" id="tourRestartBtn" style="display: none;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                            <circle cx="12" cy="17" r="0.5" fill="currentColor"/>
                        </svg>
                        Take the Tour
                    </button>
                </div>
            </div>

            <!-- DISC-113: Time Savings Calculator -->
            <div class="time-savings-section" id="timeSavingsSection">
                <h3>How Much Time Will You Save?</h3>
                <p class="time-savings-intro">Contractors spend 15-30 minutes writing each quote by hand. Quoted does it in seconds.</p>

                <div class="calculator-row">
                    <label for="quotesPerDay">Quotes you send per day:</label>
                    <input type="number" id="quotesPerDay" min="1" max="50" value="5" onchange="calculateSavings()" oninput="calculateSavings()">
                </div>

                <div class="savings-grid">
                    <div class="savings-card">
                        <div class="label">Daily</div>
                        <div class="value" id="dailySavings">1.25</div>
                        <div class="unit">hours saved</div>
                    </div>
                    <div class="savings-card highlight">
                        <div class="label">Weekly</div>
                        <div class="value" id="weeklySavings">6.25</div>
                        <div class="unit">hours saved</div>
                    </div>
                    <div class="savings-card">
                        <div class="label">Monthly</div>
                        <div class="value" id="monthlySavings">25</div>
                        <div class="unit">hours saved</div>
                    </div>
                </div>

                <p class="savings-insight" id="savingsInsight">
                    That's <strong>25 hours</strong> back every month for actual jobs or family time.
                </p>
            </div>

            <!-- CTA Section -->
            <div class="cta-section">
                <h2>Imagine This With YOUR Pricing</h2>
                <p>This demo used industry-standard estimates. With Quoted, the AI learns exactly how YOU price jobs - your rates, your materials markup, your crew costs.</p>

                <div class="cta-benefits">
                    <span class="cta-benefit">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"/>
                        </svg>
                        Learns your pricing patterns
                    </span>
                    <span class="cta-benefit">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"/>
                        </svg>
                        Gets smarter with every quote
                    </span>
                    <span class="cta-benefit">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"/>
                        </svg>
                        Your logo on every PDF
                    </span>
                </div>

                <a href="/app" class="cta-btn">Start Your Free Trial</a>
                <p style="margin-top: 12px; font-size: 0.875rem; color: var(--text-secondary);">Includes 75 quotes  No credit card required</p>
            </div>
        </div>
    </div>

    <!-- DISC-110: Product Tour Elements -->
    <div class="tour-overlay" id="tourOverlay"></div>
    <div class="tour-spotlight" id="tourSpotlight"></div>

    <!-- Tour Welcome Prompt -->
    <div class="tour-welcome" id="tourWelcome">
        <div class="tour-welcome-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
                <line x1="9" y1="9" x2="9.01" y2="9"/>
                <line x1="15" y1="9" x2="15.01" y2="9"/>
            </svg>
        </div>
        <h2>Nice quote! Want to see the full picture?</h2>
        <p>Quoted does way more than voice-to-quote. See the CRM, invoicing, learning AI, and features that save hours every week.</p>
        <div class="tour-welcome-actions">
            <button class="tour-btn primary" id="tourStartBtn">
                Show me (60 seconds)
            </button>
            <button class="tour-welcome-skip" id="tourSkipBtn">
                Skip  I'll explore on my own
            </button>
        </div>
    </div>

    <!-- Tour Tooltip (positioned dynamically) -->
    <div class="tour-tooltip" id="tourTooltip">
        <span class="tour-tooltip-badge" id="tourBadge">Feature</span>
        <h3 class="tour-tooltip-title" id="tourTitle">Feature Title</h3>
        <p class="tour-tooltip-body" id="tourBody">Feature description</p>
        <div id="tourPreview"></div>
        <div class="tour-nav">
            <div class="tour-nav-progress" id="tourProgress"></div>
            <div class="tour-nav-buttons">
                <button class="tour-btn" id="tourPrevBtn">Back</button>
                <button class="tour-btn primary" id="tourNextBtn">Next</button>
            </div>
        </div>
    </div>

    <!-- Tour Final CTA -->
    <div class="tour-final" id="tourFinal">
        <div class="tour-final-checkmark">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polyline points="20 6 9 17 4 12"/>
            </svg>
        </div>
        <h2>You just used 10% of Quoted.</h2>
        <p class="tour-final-subtitle">The rest gets even better once it learns YOUR pricing.</p>

        <div class="tour-feature-grid">
            <div class="tour-feature-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 20V10M18 20V4M6 20v-4"/>
                </svg>
                <span>Learning AI</span>
            </div>
            <div class="tour-feature-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
                <span>Customer CRM</span>
            </div>
            <div class="tour-feature-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8M16 17H8M10 9H8"/>
                </svg>
                <span>Invoice Tracking</span>
            </div>
            <div class="tour-feature-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
                </svg>
                <span>Follow-ups</span>
            </div>
            <div class="tour-feature-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/>
                </svg>
                <span>PDF Templates</span>
            </div>
            <div class="tour-feature-item">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
                <span>Sanity Checks</span>
            </div>
        </div>

        <a href="/app" class="tour-final-cta" id="tourSignupBtn">Start Your Free Trial</a>
        <button class="tour-final-secondary" id="tourCloseBtn">Maybe later</button>
    </div>

    <script>
        // State
        var mediaRecorder = null;
        var audioChunks = [];
        var isRecording = false;
        var currentQuoteData = null;

        // DOM Elements
        var voiceTab = document.getElementById('voiceTab');
        var textTab = document.getElementById('textTab');
        var voiceContent = document.getElementById('voiceContent');
        var textContent = document.getElementById('textContent');
        var recordBtn = document.getElementById('recordBtn');
        var recordStatus = document.getElementById('recordStatus');
        var waveform = document.getElementById('waveform');
        var descriptionInput = document.getElementById('descriptionInput');
        var generateBtn = document.getElementById('generateBtn');
        var errorMessage = document.getElementById('errorMessage');
        var resultsSection = document.getElementById('resultsSection');

        // DISC-136: Critical analytics - track page view and user engagement
        (function() {
            // Track page view immediately
            if (window.posthog) {
                var urlParams = new URLSearchParams(window.location.search);
                window.posthog.capture('try_page_viewed', {
                    referrer: document.referrer,
                    utm_source: urlParams.get('utm_source') || null,
                    utm_medium: urlParams.get('utm_medium') || null,
                    utm_campaign: urlParams.get('utm_campaign') || null,
                    gclid: urlParams.get('gclid') || null,  // Google Ads click ID
                    has_prompt: !!urlParams.get('prompt')
                });
            }

            // Track when user starts typing (first interaction)
            var hasTrackedInput = false;
            if (descriptionInput) {
                descriptionInput.addEventListener('input', function() {
                    if (!hasTrackedInput && window.posthog) {
                        hasTrackedInput = true;
                        window.posthog.capture('demo_input_started', {
                            input_method: 'text',
                            time_to_first_input_ms: performance.now()
                        });
                    }
                });
            }

            // Track when user starts recording (voice interaction)
            var hasTrackedRecording = false;
            if (recordBtn) {
                recordBtn.addEventListener('click', function() {
                    if (!hasTrackedRecording && window.posthog) {
                        hasTrackedRecording = true;
                        window.posthog.capture('demo_recording_started', {
                            time_to_first_record_ms: performance.now()
                        });
                    }
                });
            }

            // Track page abandonment (user leaves before generating)
            var hasGenerated = false;
            window.addEventListener('beforeunload', function() {
                if (!hasGenerated && window.posthog) {
                    window.posthog.capture('demo_abandoned', {
                        had_input: hasTrackedInput || hasTrackedRecording,
                        time_on_page_ms: performance.now()
                    });
                }
            });

            // Mark when quote is generated (to prevent false abandonment tracking)
            window.markQuoteGenerated = function() {
                hasGenerated = true;
            };

            // Track all signup link clicks (nav CTA, etc.)
            document.querySelectorAll('a[href="/app"], a.nav-cta').forEach(function(link) {
                link.addEventListener('click', function(e) {
                    var source = link.classList.contains('nav-cta') ? 'nav_cta' : 'other_link';
                    if (window.posthog) {
                        window.posthog.capture('signup_link_clicked', {
                            source: source,
                            quote_generated: hasGenerated,
                            time_on_page_ms: performance.now()
                        });
                    }
                    // Google Ads event for optimization
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'signup_cta_clicked', {
                            'event_category': 'conversion',
                            'event_label': source,
                            'value': 9
                        });
                    }
                });
            });
        })();

        // DISC-131: Handle ?prompt= query parameter from demo page
        (function() {
            var urlParams = new URLSearchParams(window.location.search);
            var prompt = urlParams.get('prompt');
            if (prompt) {
                // Pre-fill the text area with the prompt
                descriptionInput.value = decodeURIComponent(prompt);
                // Switch to text tab
                textTab.classList.add('active');
                voiceTab.classList.remove('active');
                textContent.classList.add('active');
                voiceContent.classList.remove('active');
                // Focus the textarea
                setTimeout(function() {
                    descriptionInput.focus();
                }, 100);
            }
        })();

        // DISC-113: Time Savings Calculator
        function calculateSavings() {
            var quotesPerDay = parseInt(document.getElementById('quotesPerDay').value) || 5;

            // Clamp to valid range
            if (quotesPerDay < 1) quotesPerDay = 1;
            if (quotesPerDay > 50) quotesPerDay = 50;

            // 15 minutes saved per quote (average)
            var minutesSavedPerQuote = 15;
            var dailyMinutes = quotesPerDay * minutesSavedPerQuote;
            var dailyHours = dailyMinutes / 60;
            var weeklyHours = dailyHours * 5; // 5-day work week
            var monthlyHours = weeklyHours * 4;

            // Format numbers
            function formatHours(hours) {
                if (hours < 1) {
                    return Math.round(hours * 60) + ' min';
                }
                return hours.toFixed(hours % 1 === 0 ? 0 : 1);
            }

            document.getElementById('dailySavings').textContent = formatHours(dailyHours);
            document.getElementById('weeklySavings').textContent = formatHours(weeklyHours);
            document.getElementById('monthlySavings').textContent = Math.round(monthlyHours);

            // Update insight text using safe DOM manipulation
            var insightEl = document.getElementById('savingsInsight');
            insightEl.textContent = '';
            insightEl.appendChild(document.createTextNode("That's "));
            var strongEl = document.createElement('strong');
            strongEl.textContent = Math.round(monthlyHours) + ' hours';
            insightEl.appendChild(strongEl);
            insightEl.appendChild(document.createTextNode(' back every month for actual jobs or family time.'));

            // Track engagement (debounced) - only if PostHog available
            if (window.posthog) {
                if (window.savingsCalcTimeout) clearTimeout(window.savingsCalcTimeout);
                window.savingsCalcTimeout = setTimeout(function() {
                    window.posthog.capture('time_savings_calculated', {
                        quotes_per_day: quotesPerDay,
                        monthly_hours_saved: Math.round(monthlyHours)
                    });
                }, 1000);
            }
        }

        // Tab switching
        voiceTab.addEventListener('click', function() {
            voiceTab.classList.add('active');
            textTab.classList.remove('active');
            voiceContent.classList.add('active');
            textContent.classList.remove('active');
        });

        textTab.addEventListener('click', function() {
            textTab.classList.add('active');
            voiceTab.classList.remove('active');
            textContent.classList.add('active');
            voiceContent.classList.remove('active');
        });

        // Example chips
        document.querySelectorAll('.example-chip').forEach(function(chip) {
            chip.addEventListener('click', function() {
                descriptionInput.value = chip.dataset.example;
                descriptionInput.focus();
            });
        });

        // Voice recording
        recordBtn.addEventListener('click', async function() {
            if (isRecording) {
                stopRecording();
            } else {
                await startRecording();
            }
        });

        async function startRecording() {
            try {
                var stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];

                mediaRecorder.ondataavailable = function(e) {
                    audioChunks.push(e.data);
                };

                mediaRecorder.onstop = async function() {
                    var audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    await generateQuoteFromAudio(audioBlob);
                };

                mediaRecorder.start();
                isRecording = true;
                recordBtn.classList.add('recording');
                waveform.classList.add('visible');
                recordStatus.textContent = 'Recording... Tap to stop';
            } catch (err) {
                console.error('Microphone error:', err);
                showError('Could not access microphone. Please allow microphone access or use text input instead.');
            }
        }

        function stopRecording() {
            if (mediaRecorder && isRecording) {
                mediaRecorder.stop();
                mediaRecorder.stream.getTracks().forEach(function(track) {
                    track.stop();
                });
                isRecording = false;
                recordBtn.classList.remove('recording');
                waveform.classList.remove('visible');
                recordStatus.textContent = 'Processing your recording...';
            }
        }

        // Generate quote from audio
        async function generateQuoteFromAudio(audioBlob) {
            showLoading(true);
            hideError();

            var formData = new FormData();
            formData.append('audio', audioBlob, 'recording.webm');

            try {
                var response = await fetch('/api/demo/quote', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    var data = await response.json();
                    throw new Error(data.detail || 'Failed to generate quote');
                }

                var data = await response.json();
                currentQuoteData = data;
                displayResults(data);
                if (window.markQuoteGenerated) window.markQuoteGenerated();

                // Track successful quote generation
                if (window.posthog) {
                    window.posthog.capture('demo_quote_generated', {
                        input_method: 'voice',
                        total: data.total || data.subtotal,
                        line_items_count: (data.line_items || []).length,
                        time_to_quote_ms: performance.now()
                    });
                }
                recordStatus.textContent = 'Tap to start recording';
            } catch (err) {
                showError(err.message);
                recordStatus.textContent = 'Tap to start recording';
            } finally {
                showLoading(false);
            }
        }

        // Generate quote from text
        generateBtn.addEventListener('click', async function() {
            var description = descriptionInput.value.trim();
            if (!description) {
                showError('Please enter a job description');
                return;
            }

            showLoading(true);
            hideError();

            var formData = new FormData();
            formData.append('description', description);

            try {
                var response = await fetch('/api/demo/quote', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    var errData = await response.json();
                    throw new Error(errData.detail || 'Failed to generate quote');
                }

                var data = await response.json();
                currentQuoteData = data;
                displayResults(data);
                if (window.markQuoteGenerated) window.markQuoteGenerated();

                // Track successful quote generation
                if (window.posthog) {
                    window.posthog.capture('demo_quote_generated', {
                        input_method: 'text',
                        total: data.total || data.subtotal,
                        line_items_count: (data.line_items || []).length,
                        time_to_quote_ms: performance.now()
                    });
                }
            } catch (err) {
                showError(err.message);
            } finally {
                showLoading(false);
            }
        });

        // Helper to clear all children from an element
        function clearChildren(element) {
            while (element.firstChild) {
                element.removeChild(element.firstChild);
            }
        }

        // Display results using safe DOM manipulation
        function displayResults(data) {
            // Job type
            var jobTypeEl = document.getElementById('jobType');
            jobTypeEl.textContent = formatJobType(data.job_type || 'Quote');

            // Confidence badge
            var confidenceBadge = document.getElementById('confidenceBadge');
            var confidence = (data.confidence || 'medium').toLowerCase();
            confidenceBadge.className = 'confidence-badge ' + confidence;
            confidenceBadge.textContent = confidence.charAt(0).toUpperCase() + confidence.slice(1) + ' Confidence';

            // Job description
            var jobDescEl = document.getElementById('jobDescription');
            jobDescEl.textContent = data.job_description || 'No description provided';

            // Line items - using safe DOM manipulation
            var lineItemsContainer = document.getElementById('lineItems');
            clearChildren(lineItemsContainer);

            if (data.line_items && data.line_items.length > 0) {
                data.line_items.forEach(function(item) {
                    var itemEl = document.createElement('div');
                    itemEl.className = 'line-item';

                    var infoEl = document.createElement('div');
                    infoEl.className = 'line-item-info';

                    var nameEl = document.createElement('div');
                    nameEl.className = 'line-item-name';
                    nameEl.textContent = item.name || 'Item';
                    infoEl.appendChild(nameEl);

                    if (item.description) {
                        var descEl = document.createElement('div');
                        descEl.className = 'line-item-desc';
                        descEl.textContent = item.description;
                        infoEl.appendChild(descEl);
                    }

                    var amountEl = document.createElement('div');
                    amountEl.className = 'line-item-amount';
                    amountEl.textContent = '$' + (item.amount || 0).toLocaleString();

                    itemEl.appendChild(infoEl);
                    itemEl.appendChild(amountEl);
                    lineItemsContainer.appendChild(itemEl);
                });
            }

            // Total
            var totalEl = document.getElementById('quoteTotal');
            totalEl.textContent = '$' + (data.subtotal || data.total || 0).toLocaleString();

            // Notes
            var notesSection = document.getElementById('notesSection');
            var notesEl = document.getElementById('quoteNotes');
            if (data.notes) {
                notesEl.textContent = data.notes;
                notesSection.style.display = 'block';
            } else {
                notesSection.style.display = 'none';
            }

            // DISC-132: Interactive Clarifying Questions
            var questionsSection = document.getElementById('questionsSection');
            var questionList = document.getElementById('questionList');
            var regenerateBtn = document.getElementById('regenerateBtn');
            clearChildren(questionList);

            if (data.questions && data.questions.length > 0) {
                data.questions.forEach(function(question, index) {
                    // Create question item container
                    var questionItem = document.createElement('div');
                    questionItem.className = 'question-item';

                    // Create label
                    var label = document.createElement('label');
                    label.setAttribute('for', 'question-' + index);
                    label.textContent = question;

                    // Create input field
                    var input = document.createElement('input');
                    input.type = 'text';
                    input.id = 'question-' + index;
                    input.className = 'question-input';
                    input.setAttribute('data-question', question);
                    input.placeholder = 'Type your answer...';

                    // Show regenerate button when user starts typing
                    input.addEventListener('input', function() {
                        var anyAnswered = document.querySelectorAll('.question-input').length > 0 &&
                            Array.from(document.querySelectorAll('.question-input')).some(function(inp) {
                                return inp.value.trim() !== '';
                            });
                        regenerateBtn.style.display = anyAnswered ? 'flex' : 'none';
                    });

                    questionItem.appendChild(label);
                    questionItem.appendChild(input);
                    questionList.appendChild(questionItem);
                });
                questionsSection.style.display = 'block';
                regenerateBtn.style.display = 'none'; // Hide until user answers something
            } else {
                questionsSection.style.display = 'none';
                regenerateBtn.style.display = 'none';
            }

            // Show results section
            resultsSection.classList.add('visible');
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function formatJobType(jobType) {
            if (!jobType) return 'Quote';
            return jobType
                .replace(/_/g, ' ')
                .replace(/\b\w/g, function(l) { return l.toUpperCase(); });
        }

        // Download PDF
        document.getElementById('downloadPdfBtn').addEventListener('click', async function() {
            if (!currentQuoteData) return;

            var btn = this;
            btn.disabled = true;
            var originalText = btn.textContent;
            btn.textContent = 'Generating PDF...';

            try {
                var response = await fetch('/api/demo/pdf', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        quote_data: currentQuoteData
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to generate PDF');
                }

                var data = await response.json();

                // Convert base64 to blob and download
                var byteCharacters = atob(data.pdf_base64);
                var byteNumbers = new Array(byteCharacters.length);
                for (var i = 0; i < byteCharacters.length; i++) {
                    byteNumbers[i] = byteCharacters.charCodeAt(i);
                }
                var byteArray = new Uint8Array(byteNumbers);
                var blob = new Blob([byteArray], { type: 'application/pdf' });

                var url = URL.createObjectURL(blob);
                var a = document.createElement('a');
                a.href = url;
                a.download = data.filename || 'demo-quote.pdf';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (err) {
                showError('Failed to generate PDF. Please try again.');
            } finally {
                btn.disabled = false;
                btn.textContent = originalText;
            }
        });

        // Try again button
        document.getElementById('tryAgainBtn').addEventListener('click', function() {
            resultsSection.classList.remove('visible');
            descriptionInput.value = '';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // DISC-132: Regenerate quote with clarification answers
        document.getElementById('regenerateBtn').addEventListener('click', async function() {
            if (!currentQuoteData || !currentQuoteData.transcription) return;

            var btn = this;
            btn.disabled = true;
            btn.classList.add('loading');

            // Store original content using safe DOM methods
            var originalChildren = Array.from(btn.childNodes).map(function(node) {
                return node.cloneNode(true);
            });

            // Clear and set loading state using safe DOM manipulation
            while (btn.firstChild) {
                btn.removeChild(btn.firstChild);
            }
            var loadingSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            loadingSvg.setAttribute('viewBox', '0 0 24 24');
            loadingSvg.setAttribute('fill', 'none');
            loadingSvg.setAttribute('stroke', 'currentColor');
            loadingSvg.setAttribute('stroke-width', '2');
            var path1 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path1.setAttribute('d', 'M1 4v6h6');
            var path2 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path2.setAttribute('d', 'M23 20v-6h-6');
            var path3 = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path3.setAttribute('d', 'M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15');
            loadingSvg.appendChild(path1);
            loadingSvg.appendChild(path2);
            loadingSvg.appendChild(path3);
            btn.appendChild(loadingSvg);
            btn.appendChild(document.createTextNode(' Regenerating...'));

            try {
                // Collect answers from input fields
                var clarifications = [];
                var inputs = document.querySelectorAll('.question-input');
                inputs.forEach(function(input) {
                    var answer = input.value.trim();
                    if (answer) {
                        clarifications.push({
                            question: input.getAttribute('data-question'),
                            answer: answer
                        });
                    }
                });

                if (clarifications.length === 0) {
                    showError('Please answer at least one question to regenerate.');
                    return;
                }

                // Track regeneration attempt
                if (typeof posthog !== 'undefined') {
                    posthog.capture('demo_quote_regenerate_started', {
                        original_total: currentQuoteData.total || currentQuoteData.subtotal,
                        questions_answered: clarifications.length
                    });
                }

                var response = await fetch('/api/demo/regenerate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        transcription: currentQuoteData.transcription,
                        clarifications: clarifications
                    })
                });

                if (!response.ok) {
                    var errorData = await response.json().catch(function() { return {}; });
                    throw new Error(errorData.detail || 'Failed to regenerate quote');
                }

                var data = await response.json();
                currentQuoteData = data;
                displayResults(data);
                if (window.markQuoteGenerated) window.markQuoteGenerated();

                // Track successful regeneration
                if (typeof posthog !== 'undefined') {
                    posthog.capture('demo_quote_regenerated', {
                        new_total: data.total || data.subtotal,
                        questions_answered: clarifications.length
                    });
                }

                // Scroll to top of results
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

            } catch (err) {
                showError('Failed to regenerate quote: ' + err.message);
            } finally {
                btn.disabled = false;
                btn.classList.remove('loading');
                // Restore original content
                while (btn.firstChild) {
                    btn.removeChild(btn.firstChild);
                }
                originalChildren.forEach(function(child) {
                    btn.appendChild(child);
                });
            }
        });

        // Share quote button
        document.getElementById('shareQuoteBtn').addEventListener('click', async function() {
            if (!currentQuoteData) return;

            var total = currentQuoteData.total || 0;
            var jobType = formatJobType(currentQuoteData.job_type);
            var shareText = 'Just generated a $' + total.toLocaleString() + ' ' + jobType + ' quote in 30 seconds with Quoted - voice to quote is wild!';
            var shareUrl = 'https://quoted.it.com/try?utm_source=demo_share&utm_medium=social';

            // Track share attempt
            if (typeof posthog !== 'undefined') {
                posthog.capture('demo_quote_share_clicked', {
                    quote_total: total,
                    job_type: currentQuoteData.job_type
                });
            }

            // Try Web Share API first (mobile/modern browsers)
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'Quoted - Voice to Quote',
                        text: shareText,
                        url: shareUrl
                    });
                    if (typeof posthog !== 'undefined') {
                        posthog.capture('demo_quote_shared', {
                            quote_total: total,
                            job_type: currentQuoteData.job_type,
                            method: 'web_share_api'
                        });
                    }
                    showShareSuccess('Shared successfully!');
                } catch (err) {
                    // User cancelled or error - fall back to clipboard
                    if (err.name !== 'AbortError') {
                        copyShareToClipboard(shareText, shareUrl, total);
                    }
                }
            } else {
                // Fallback: copy to clipboard
                copyShareToClipboard(shareText, shareUrl, total);
            }
        });

        function copyShareToClipboard(text, url, total) {
            var fullText = text + '\n\n' + url;
            navigator.clipboard.writeText(fullText).then(function() {
                if (typeof posthog !== 'undefined') {
                    posthog.capture('demo_quote_shared', {
                        quote_total: total,
                        job_type: currentQuoteData ? currentQuoteData.job_type : 'unknown',
                        method: 'clipboard'
                    });
                }
                showShareSuccess('Copied to clipboard! Paste anywhere to share.');
            }).catch(function() {
                showShareSuccess('Copy this text to share your quote!');
            });
        }

        function showShareSuccess(message) {
            var btn = document.getElementById('shareQuoteBtn');
            // Store original content
            var originalChildren = Array.from(btn.childNodes).map(function(node) {
                return node.cloneNode(true);
            });
            var originalBg = btn.style.background;
            var originalColor = btn.style.color;

            // Clear and set success state
            while (btn.firstChild) {
                btn.removeChild(btn.firstChild);
            }
            var checkSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            checkSvg.setAttribute('viewBox', '0 0 24 24');
            checkSvg.setAttribute('fill', 'none');
            checkSvg.setAttribute('stroke', 'currentColor');
            checkSvg.setAttribute('stroke-width', '2');
            var polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
            polyline.setAttribute('points', '20 6 9 17 4 12');
            checkSvg.appendChild(polyline);
            btn.appendChild(checkSvg);
            btn.appendChild(document.createTextNode(' ' + message));
            btn.style.background = 'var(--accent)';
            btn.style.color = 'white';

            setTimeout(function() {
                while (btn.firstChild) {
                    btn.removeChild(btn.firstChild);
                }
                originalChildren.forEach(function(child) {
                    btn.appendChild(child);
                });
                btn.style.background = originalBg;
                btn.style.color = originalColor;
            }, 3000);
        }

        // Helper functions
        var progressInterval = null;
        var progressBarInterval = null;
        var progressStartTime = null;

        // Progress steps with timing (total ~15s)
        var progressSteps = [
            { message: "Analyzing your job description...", duration: 3000 },
            { message: "Identifying line items...", duration: 4000 },
            { message: "Calculating pricing...", duration: 4000 },
            { message: "Generating professional quote...", duration: 4000 }
        ];

        function showLoading(show) {
            generateBtn.classList.toggle('loading', show);
            generateBtn.disabled = show;

            var progressContainer = document.getElementById('progressContainer');
            var progressBar = document.getElementById('progressBar');
            var progressMessage = document.getElementById('progressMessage');

            if (show) {
                // Show progress container
                progressContainer.classList.add('visible');
                progressStartTime = Date.now();

                // Reset progress
                progressBar.style.width = '0%';
                resetProgressDots();

                // Start cycling through progress steps
                var currentStep = 0;
                updateProgressStep(currentStep);

                progressInterval = setInterval(function() {
                    currentStep++;
                    if (currentStep < progressSteps.length) {
                        updateProgressStep(currentStep);
                    }
                }, progressSteps[0].duration);

                // Smooth progress bar animation
                var totalDuration = 15000; // 15 seconds expected
                var updateFrequency = 100; // Update every 100ms
                progressBarInterval = setInterval(function() {
                    var elapsed = Date.now() - progressStartTime;
                    var progress = Math.min((elapsed / totalDuration) * 95, 95); // Cap at 95% until done
                    progressBar.style.width = progress + '%';
                }, updateFrequency);

            } else {
                // Complete the progress bar
                progressBar.style.width = '100%';

                // Mark all steps as completed
                for (var i = 1; i <= 4; i++) {
                    var dot = document.getElementById('dot' + i);
                    if (dot) {
                        dot.classList.remove('active');
                        dot.classList.add('completed');
                    }
                }

                // Clear intervals
                if (progressInterval) {
                    clearInterval(progressInterval);
                    progressInterval = null;
                }
                if (progressBarInterval) {
                    clearInterval(progressBarInterval);
                    progressBarInterval = null;
                }

                // Hide progress container after a brief delay
                setTimeout(function() {
                    progressContainer.classList.remove('visible');
                    progressBar.style.width = '0%';
                    resetProgressDots();
                }, 500);
            }
        }

        function updateProgressStep(stepIndex) {
            var progressMessage = document.getElementById('progressMessage');
            if (stepIndex < progressSteps.length) {
                progressMessage.textContent = progressSteps[stepIndex].message;

                // Update dots
                for (var i = 0; i < 4; i++) {
                    var dot = document.getElementById('dot' + (i + 1));
                    if (dot) {
                        if (i < stepIndex) {
                            dot.classList.remove('active');
                            dot.classList.add('completed');
                        } else if (i === stepIndex) {
                            dot.classList.add('active');
                            dot.classList.remove('completed');
                        } else {
                            dot.classList.remove('active', 'completed');
                        }
                    }
                }
            }
        }

        function resetProgressDots() {
            for (var i = 1; i <= 4; i++) {
                var dot = document.getElementById('dot' + i);
                if (dot) {
                    dot.classList.remove('active', 'completed');
                    if (i === 1) dot.classList.add('active');
                }
            }
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.add('visible');
        }

        function hideError() {
            errorMessage.classList.remove('visible');
        }

        // ========== DISC-110: Product Tour System ==========

        // Tour state
        var tourCurrentStep = 0;
        var tourShownThisSession = false;
        var tourScrollPosition = 0; // DISC-155: Store scroll position for restoration

        {% raw %}
        // Helper to create text with highlighted portions
        // Format: "Regular text {{highlighted text}} more regular text"
        function createHighlightedText(text) {
            var fragment = document.createDocumentFragment();
            var parts = text.split(/(\{\{.*?\}\})/g);
            parts.forEach(function(part) {
                if (part.startsWith('{{') && part.endsWith('}}')) {
                    var span = document.createElement('span');
                    span.className = 'tour-tooltip-highlight';
                    span.textContent = part.slice(2, -2);
                    fragment.appendChild(span);
                } else if (part) {
                    fragment.appendChild(document.createTextNode(part));
                }
            });
            return fragment;
        }

        // Helper to create preview card
        function createPreviewCard(rows) {
            var card = document.createElement('div');
            card.className = 'tour-preview-card';
            rows.forEach(function(row) {
                var rowEl = document.createElement('div');
                rowEl.className = 'tour-preview-row';
                if (row.label) {
                    var labelEl = document.createElement('span');
                    labelEl.className = 'tour-preview-label';
                    labelEl.textContent = row.label;
                    rowEl.appendChild(labelEl);
                }
                if (row.value) {
                    var valueEl = document.createElement('span');
                    valueEl.className = 'tour-preview-value';
                    valueEl.textContent = row.value;
                    rowEl.appendChild(valueEl);
                }
                if (row.badge) {
                    var badgeEl = document.createElement('span');
                    badgeEl.className = 'tour-preview-badge';
                    badgeEl.textContent = row.badge;
                    rowEl.appendChild(badgeEl);
                }
                card.appendChild(rowEl);
            });
            return card;
        }

        var tourSteps = [
            {
                target: '#lineItems',
                badge: 'Learning AI',
                title: 'Your Pricing, Learned',
                body: 'In your account, tap any line to edit. {{Every change trains the AI on YOUR pricing}}. After a few corrections, it learns exactly how you price jobs.',
                preview: null,
                demoNote: 'Start your free trial to unlock editing and learning'
            },
            {
                target: '#downloadPdfBtn',
                badge: 'Instant Delivery',
                title: 'Professional PDFs',
                body: 'Download beautiful PDF quotes instantly. {{8 templates + your logo}}. Send to clients in seconds, not hours.',
                preview: null
            },
            {
                target: '#shareQuoteBtn',
                badge: 'Share & Track',
                title: 'Know When They View It',
                body: 'Send quotes via link and {{see when clients open them}}. No more "did they get my quote?" guessing.',
                preview: null
            },
            {
                target: null,
                badge: 'One Tap',
                title: 'Quote  Invoice',
                body: 'Client approved? {{Convert to invoice with one tap}}. Same line items, same totalszero re-entry.',
                preview: [
                    { label: 'Quote #1234', value: '$2,450' },
                    { label: 'Status', badge: ' Approved' },
                    { label: '', value: 'Invoice #5678' }
                ]
            },
            {
                target: null,
                badge: 'Built-in CRM',
                title: 'All Your Customers',
                body: 'Every quote auto-creates a customer record. {{Track history, contact info, and notes}} without a separate CRM.',
                preview: [
                    { label: 'Sarah Miller', value: '$12,340 total' },
                    { label: 'Quotes', value: '4' },
                    { label: 'Last contact', value: '2 days ago' }
                ]
            },
            {
                target: null,
                badge: 'Never Forget',
                title: 'Follow-up Reminders',
                body: 'Set reminders to follow up on open quotes. {{Get notified before opportunities go cold}}.',
                preview: [
                    { label: ' Tomorrow 9am' },
                    { label: 'Follow up on', value: 'Bathroom Remodel' },
                    { label: 'Customer', value: 'Sarah Miller' }
                ]
            }
        ];
        {% endraw %}

        // Tour DOM elements
        var tourOverlay = document.getElementById('tourOverlay');
        var tourSpotlight = document.getElementById('tourSpotlight');
        var tourWelcome = document.getElementById('tourWelcome');
        var tourTooltip = document.getElementById('tourTooltip');
        var tourFinal = document.getElementById('tourFinal');
        var tourBadge = document.getElementById('tourBadge');
        var tourTitle = document.getElementById('tourTitle');
        var tourBody = document.getElementById('tourBody');
        var tourPreview = document.getElementById('tourPreview');
        var tourProgress = document.getElementById('tourProgress');
        var tourStartBtn = document.getElementById('tourStartBtn');
        var tourSkipBtn = document.getElementById('tourSkipBtn');
        var tourNextBtn = document.getElementById('tourNextBtn');
        var tourPrevBtn = document.getElementById('tourPrevBtn');
        var tourCloseBtn = document.getElementById('tourCloseBtn');
        var tourSignupBtn = document.getElementById('tourSignupBtn');
        var tourRestartBtn = document.getElementById('tourRestartBtn'); // DISC-157

        // Check if tour should be shown
        function shouldShowTour() {
            if (tourShownThisSession) return false;
            if (localStorage.getItem('quoted_demo_tour_dismissed')) return false;
            return true;
        }

        // Show tour welcome prompt
        function showTourPrompt() {
            if (!shouldShowTour()) return;

            tourShownThisSession = true;

            // Track tour prompt shown
            if (typeof posthog !== 'undefined') {
                posthog.capture('tour_prompt_shown', { page: 'demo_try' });
            }

            // DISC-155: Lock body scroll and preserve position
            tourScrollPosition = window.scrollY;
            document.body.classList.add('tour-active');
            document.body.style.top = '-' + tourScrollPosition + 'px';

            // Show overlay and welcome
            tourOverlay.classList.add('active');
            tourWelcome.classList.add('active');
        }

        // Start the tour
        function startTour() {
            // Track tour started
            if (typeof posthog !== 'undefined') {
                posthog.capture('tour_started', { page: 'demo_try' });
            }

            // Hide welcome, show tooltip
            tourWelcome.classList.remove('active');
            tourTooltip.classList.add('active');
            tourCurrentStep = 0;
            showTourStep(tourCurrentStep);
        }

        // Show a specific tour step
        function showTourStep(stepIndex) {
            var step = tourSteps[stepIndex];
            if (!step) return;

            // Track step view
            if (typeof posthog !== 'undefined') {
                posthog.capture('tour_step_viewed', {
                    step_index: stepIndex,
                    step_badge: step.badge,
                    page: 'demo_try'
                });
            }

            // Update content using safe DOM methods
            tourBadge.textContent = step.badge;
            tourTitle.textContent = step.title;

            // Clear and set body with highlighted text
            clearChildren(tourBody);
            tourBody.appendChild(createHighlightedText(step.body));

            // DISC-155: Show demo note if present (clarifies demo vs full account)
            if (step.demoNote) {
                var noteEl = document.createElement('div');
                noteEl.className = 'tour-demo-note';
                noteEl.textContent = step.demoNote;
                tourBody.appendChild(noteEl);
            }

            // Update preview using safe DOM methods
            clearChildren(tourPreview);
            if (step.preview) {
                tourPreview.appendChild(createPreviewCard(step.preview));
                tourPreview.style.display = 'block';
            } else {
                tourPreview.style.display = 'none';
            }

            // Update progress dots
            updateProgressDots(stepIndex);

            // Update nav buttons
            tourPrevBtn.style.display = stepIndex === 0 ? 'none' : 'inline-flex';
            tourNextBtn.textContent = stepIndex === tourSteps.length - 1 ? 'Finish' : 'Next';

            // Scroll and position spotlight/tooltip
            if (step.target) {
                var targetEl = document.querySelector(step.target);
                if (targetEl) {
                    // DISC-155: Hide spotlight during transition for smoother feel
                    tourSpotlight.classList.remove('active');
                    tourSpotlight.style.opacity = '0';

                    // Scroll target element into view first
                    targetEl.scrollIntoView({ behavior: 'smooth', block: 'center' });

                    // DISC-155: Wait for scroll animation, then smoothly reveal spotlight
                    setTimeout(function() {
                        positionSpotlight(targetEl);
                        positionTooltip(targetEl);
                        // Add slight delay before revealing for smoother transition
                        requestAnimationFrame(function() {
                            tourSpotlight.style.opacity = '';
                            tourSpotlight.classList.add('active');
                        });
                    }, 450);
                } else {
                    tourSpotlight.classList.remove('active');
                    centerTooltip();
                }
            } else {
                // Visual-only step - hide spotlight
                tourSpotlight.classList.remove('active');
                // Scroll results section into view for context
                var resultsEl = document.getElementById('resultsSection');
                if (resultsEl) {
                    resultsEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
                // Wait for scroll, then center tooltip
                setTimeout(function() {
                    centerTooltip();
                }, 400);
            }
        }

        // Update progress dots
        function updateProgressDots(currentIndex) {
            clearChildren(tourProgress);
            for (var i = 0; i < tourSteps.length; i++) {
                var dot = document.createElement('div');
                dot.className = 'tour-progress-dot';
                if (i === currentIndex) {
                    dot.classList.add('active');
                } else if (i < currentIndex) {
                    dot.classList.add('completed');
                }
                tourProgress.appendChild(dot);
            }
        }

        // Position spotlight around target element
        function positionSpotlight(targetEl) {
            var rect = targetEl.getBoundingClientRect();
            var padding = 12;

            tourSpotlight.style.top = (rect.top - padding) + 'px';
            tourSpotlight.style.left = (rect.left - padding) + 'px';
            tourSpotlight.style.width = (rect.width + padding * 2) + 'px';
            tourSpotlight.style.height = (rect.height + padding * 2) + 'px';
        }

        // DISC-157: Position tooltip near target element with proper viewport constraints
        function positionTooltip(targetEl) {
            var rect = targetEl.getBoundingClientRect();
            var isMobile = window.innerWidth <= 768;
            var padding = 20; // Min distance from viewport edge
            var tooltipWidth = 340;
            var tooltipHeight = 280; // Approximate max height

            // Reset transform and position from centerTooltip
            tourTooltip.style.transform = '';
            tourTooltip.style.right = '';

            if (isMobile) {
                // Mobile: bottom sheet style (handled by CSS)
                tourTooltip.style.top = 'auto';
                tourTooltip.style.left = '0';
                tourTooltip.style.right = '0';
                tourTooltip.style.bottom = '0';
            } else {
                // Desktop: position below target by default
                var top = rect.bottom + padding;
                var left = rect.left + (rect.width / 2) - (tooltipWidth / 2);

                // Constrain horizontal position within viewport
                if (left < padding) {
                    left = padding;
                }
                if (left + tooltipWidth > window.innerWidth - padding) {
                    left = window.innerWidth - tooltipWidth - padding;
                }

                // Check if tooltip fits below the target
                var fitsBelow = (top + tooltipHeight) <= (window.innerHeight - padding);
                var fitsAbove = (rect.top - tooltipHeight - padding) >= padding;

                if (!fitsBelow && fitsAbove) {
                    // Position above if no room below but room above
                    top = rect.top - tooltipHeight - padding;
                } else if (!fitsBelow && !fitsAbove) {
                    // DISC-157: Neither above nor below works - center vertically
                    // This handles edge cases where target is in middle of small viewport
                    var viewportCenter = window.innerHeight / 2;
                    top = viewportCenter - (tooltipHeight / 2);
                    // Ensure still within bounds
                    if (top < padding) top = padding;
                    if (top + tooltipHeight > window.innerHeight - padding) {
                        top = window.innerHeight - tooltipHeight - padding;
                    }
                }

                // Final safety check: ensure top is never negative
                if (top < padding) top = padding;

                tourTooltip.style.top = top + 'px';
                tourTooltip.style.left = left + 'px';
                tourTooltip.style.bottom = 'auto';
            }
        }

        // Center tooltip (for visual-only steps)
        function centerTooltip() {
            var isMobile = window.innerWidth <= 768;

            if (isMobile) {
                tourTooltip.style.top = 'auto';
                tourTooltip.style.left = '0';
                tourTooltip.style.right = '0';
                tourTooltip.style.transform = '';
            } else {
                tourTooltip.style.top = '50%';
                tourTooltip.style.left = '50%';
                tourTooltip.style.transform = 'translate(-50%, -50%)';
            }
        }

        // Next tour step
        function nextTourStep() {
            if (tourCurrentStep < tourSteps.length - 1) {
                tourCurrentStep++;
                tourTooltip.style.transform = '';
                showTourStep(tourCurrentStep);
            } else {
                // Tour complete - show final CTA
                completeTour();
            }
        }

        // Previous tour step
        function prevTourStep() {
            if (tourCurrentStep > 0) {
                tourCurrentStep--;
                tourTooltip.style.transform = '';
                showTourStep(tourCurrentStep);
            }
        }

        // Complete the tour
        function completeTour() {
            // Track completion
            if (typeof posthog !== 'undefined') {
                posthog.capture('tour_completed', { page: 'demo_try' });
            }

            // Hide tooltip and spotlight
            tourTooltip.classList.remove('active');
            tourSpotlight.classList.remove('active');

            // Show final CTA
            tourFinal.classList.add('active');
        }

        // Skip tour
        function skipTour(rememberChoice) {
            // Track skip
            if (typeof posthog !== 'undefined') {
                posthog.capture('tour_skipped', {
                    page: 'demo_try',
                    step_index: tourCurrentStep,
                    remember_choice: rememberChoice
                });
            }

            if (rememberChoice) {
                localStorage.setItem('quoted_demo_tour_dismissed', 'true');
            }

            closeTour();
        }

        // Close tour completely
        function closeTour() {
            tourOverlay.classList.remove('active');
            tourWelcome.classList.remove('active');
            tourTooltip.classList.remove('active');
            tourSpotlight.classList.remove('active');
            tourFinal.classList.remove('active');
            tourCurrentStep = 0;

            // DISC-155: Restore body scroll
            document.body.classList.remove('tour-active');
            document.body.style.top = '';
            window.scrollTo(0, tourScrollPosition);
        }

        // DISC-157: Restart tour from beginning (bypasses session/localStorage check)
        function restartTour() {
            // Clear any previous dismissal so tour can be re-shown
            localStorage.removeItem('quoted_demo_tour_dismissed');
            tourShownThisSession = false;

            // Track restart
            if (typeof posthog !== 'undefined') {
                posthog.capture('tour_restarted', { page: 'demo_try' });
            }

            // Show tour welcome prompt directly
            showTourPrompt();
        }

        // Event listeners for tour
        tourStartBtn.addEventListener('click', function() {
            startTour();
        });

        tourSkipBtn.addEventListener('click', function() {
            skipTour(false);
        });

        tourNextBtn.addEventListener('click', function() {
            nextTourStep();
        });

        tourPrevBtn.addEventListener('click', function() {
            prevTourStep();
        });

        tourCloseBtn.addEventListener('click', function() {
            closeTour();
        });

        tourSignupBtn.addEventListener('click', function() {
            // Track signup click from tour - both PostHog and Google Ads
            if (typeof posthog !== 'undefined') {
                posthog.capture('tour_signup_clicked', {
                    page: 'demo_try',
                    source: 'tour_final_cta',
                    quote_generated: !!currentQuoteData
                });
            }
            // Google Ads event (shows in GA4, can be used for bid optimization)
            if (typeof gtag !== 'undefined') {
                gtag('event', 'signup_cta_clicked', {
                    'event_category': 'conversion',
                    'event_label': 'tour_final_cta',
                    'value': 9  // Potential $9/mo revenue
                });
            }
        });

        // DISC-157: Restart tour button click handler
        tourRestartBtn.addEventListener('click', function() {
            restartTour();
        });

        // Keyboard navigation for tour
        document.addEventListener('keydown', function(e) {
            if (!tourOverlay.classList.contains('active')) return;

            if (e.key === 'Escape') {
                skipTour(false);
            } else if (e.key === 'ArrowRight' || e.key === 'Enter') {
                if (tourTooltip.classList.contains('active')) {
                    nextTourStep();
                } else if (tourWelcome.classList.contains('active')) {
                    startTour();
                }
            } else if (e.key === 'ArrowLeft') {
                if (tourTooltip.classList.contains('active')) {
                    prevTourStep();
                }
            }
        });

        // Hook into displayResults to show tour after first quote
        var originalDisplayResults = displayResults;
        displayResults = function(data) {
            originalDisplayResults(data);

            // DISC-157: Always show tour restart button in results section
            tourRestartBtn.style.display = 'inline-flex';

            // Show tour prompt after a brief delay (only if not dismissed)
            setTimeout(function() {
                showTourPrompt();
            }, 1500);
        };

        // Handle window resize during tour
        window.addEventListener('resize', function() {
            if (!tourTooltip.classList.contains('active')) return;

            var step = tourSteps[tourCurrentStep];
            if (step && step.target) {
                var targetEl = document.querySelector(step.target);
                if (targetEl) {
                    positionSpotlight(targetEl);
                    positionTooltip(targetEl);
                }
            } else {
                centerTooltip();
            }
        });
    </script>
</body>
</html>
